<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Story Uplift modeling on marketing dataset: eXplainable predictions for optimized marketing campaigns | XAI Stories</title>
  <meta name="description" content="Case studies for eXplainable Artificial Intelligence" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Story Uplift modeling on marketing dataset: eXplainable predictions for optimized marketing campaigns | XAI Stories" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/cover.png" />
  <meta property="og:description" content="Case studies for eXplainable Artificial Intelligence" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Story Uplift modeling on marketing dataset: eXplainable predictions for optimized marketing campaigns | XAI Stories" />
  
  <meta name="twitter:description" content="Case studies for eXplainable Artificial Intelligence" />
  <meta name="twitter:image" content="images/cover.png" />

<meta name="author" content="" />


<meta name="date" content="2020-05-31" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="story-meps-healthcare-expenditures-of-individuals.html"/>
<link rel="next" href="story-uplift-marketing1.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />












<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><h3>XAI Stories</h3> Case studies</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="foreword.html"><a href="foreword.html"><i class="fa fa-check"></i>Foreword</a><ul>
<li class="chapter" data-level="0.1" data-path="foreword.html"><a href="foreword.html#why"><i class="fa fa-check"></i><b>0.1</b> Why?</a></li>
<li class="chapter" data-level="0.2" data-path="foreword.html"><a href="foreword.html#what"><i class="fa fa-check"></i><b>0.2</b> What?</a></li>
<li class="chapter" data-level="0.3" data-path="foreword.html"><a href="foreword.html#how"><i class="fa fa-check"></i><b>0.3</b> How?</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="story-house-sale-prices.html"><a href="story-house-sale-prices.html"><i class="fa fa-check"></i><b>1</b> Story House Sale Prices: eXplainable predictions for house sale</a><ul>
<li class="chapter" data-level="1.1" data-path="story-house-sale-prices.html"><a href="story-house-sale-prices.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="story-house-sale-prices.html"><a href="story-house-sale-prices.html#model"><i class="fa fa-check"></i><b>1.2</b> Model</a></li>
<li class="chapter" data-level="1.3" data-path="story-house-sale-prices.html"><a href="story-house-sale-prices.html#explanations"><i class="fa fa-check"></i><b>1.3</b> Explanations</a></li>
<li class="chapter" data-level="1.4" data-path="story-house-sale-prices.html"><a href="story-house-sale-prices.html#summary-and-conclusions"><i class="fa fa-check"></i><b>1.4</b> Summary and conclusions</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="story-hotel-booking.html"><a href="story-hotel-booking.html"><i class="fa fa-check"></i><b>2</b> Story hotel booking: eXplainable predictions of booking cancelation and guests coming back</a><ul>
<li class="chapter" data-level="2.1" data-path="story-hotel-booking.html"><a href="story-hotel-booking.html#introduction-1"><i class="fa fa-check"></i><b>2.1</b> Introduction</a><ul>
<li class="chapter" data-level="2.1.1" data-path="story-hotel-booking.html"><a href="story-hotel-booking.html#hyperparameter-optimization"><i class="fa fa-check"></i><b>2.1.1</b> Hyperparameter optimization</a></li>
<li class="chapter" data-level="2.1.2" data-path="story-hotel-booking.html"><a href="story-hotel-booking.html#imbalanced-dataset"><i class="fa fa-check"></i><b>2.1.2</b> Imbalanced dataset</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="story-hotel-booking.html"><a href="story-hotel-booking.html#model-1"><i class="fa fa-check"></i><b>2.2</b> Model</a><ul>
<li class="chapter" data-level="2.2.1" data-path="story-hotel-booking.html"><a href="story-hotel-booking.html#model-1.-booking-cancelation"><i class="fa fa-check"></i><b>2.2.1</b> Model 1. Booking cancelation</a></li>
<li class="chapter" data-level="2.2.2" data-path="story-hotel-booking.html"><a href="story-hotel-booking.html#model-2.-repeated-guests"><i class="fa fa-check"></i><b>2.2.2</b> Model 2. Repeated guests</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="story-hotel-booking.html"><a href="story-hotel-booking.html#explanations-1"><i class="fa fa-check"></i><b>2.3</b> Explanations</a><ul>
<li class="chapter" data-level="2.3.1" data-path="story-hotel-booking.html"><a href="story-hotel-booking.html#model-1.-booking-cancelation-1"><i class="fa fa-check"></i><b>2.3.1</b> Model 1. Booking cancelation</a></li>
<li class="chapter" data-level="2.3.2" data-path="story-hotel-booking.html"><a href="story-hotel-booking.html#model-2.-repeated-guests-1"><i class="fa fa-check"></i><b>2.3.2</b> Model 2. Repeated guests</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="story-hotel-booking.html"><a href="story-hotel-booking.html#summary-and-conclusions-1"><i class="fa fa-check"></i><b>2.4</b> Summary and conclusions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="story-uplift-modelling.html"><a href="story-uplift-modelling.html"><i class="fa fa-check"></i><b>3</b> Story Uplift Modelling: eXplaining colon cancer survival rate after treatment</a><ul>
<li class="chapter" data-level="3.1" data-path="story-uplift-modelling.html"><a href="story-uplift-modelling.html#introduction-2"><i class="fa fa-check"></i><b>3.1</b> Introduction</a><ul>
<li class="chapter" data-level="3.1.1" data-path="story-uplift-modelling.html"><a href="story-uplift-modelling.html#what-is-uplift-modelling"><i class="fa fa-check"></i><b>3.1.1</b> What is Uplift Modelling?</a></li>
<li class="chapter" data-level="3.1.2" data-path="story-uplift-modelling.html"><a href="story-uplift-modelling.html#dataset-description"><i class="fa fa-check"></i><b>3.1.2</b> Dataset Description</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="story-uplift-modelling.html"><a href="story-uplift-modelling.html#model-2"><i class="fa fa-check"></i><b>3.2</b> Model</a></li>
<li class="chapter" data-level="3.3" data-path="story-uplift-modelling.html"><a href="story-uplift-modelling.html#explanations-2"><i class="fa fa-check"></i><b>3.3</b> Explanations</a><ul>
<li class="chapter" data-level="3.3.1" data-path="story-uplift-modelling.html"><a href="story-uplift-modelling.html#dataset-level-explainations"><i class="fa fa-check"></i><b>3.3.1</b> Dataset Level Explainations</a></li>
<li class="chapter" data-level="3.3.2" data-path="story-uplift-modelling.html"><a href="story-uplift-modelling.html#instance-level-explainations"><i class="fa fa-check"></i><b>3.3.2</b> Instance Level Explainations</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="story-uplift-modelling.html"><a href="story-uplift-modelling.html#summary-and-conclusions-2"><i class="fa fa-check"></i><b>3.4</b> Summary and conclusions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="story-meps-regression.html"><a href="story-meps-regression.html"><i class="fa fa-check"></i><b>4</b> Story Meps: regression</a><ul>
<li class="chapter" data-level="4.1" data-path="story-meps-regression.html"><a href="story-meps-regression.html#introduction-3"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="story-meps-regression.html"><a href="story-meps-regression.html#model-3"><i class="fa fa-check"></i><b>4.2</b> Model</a></li>
<li class="chapter" data-level="4.3" data-path="story-meps-regression.html"><a href="story-meps-regression.html#explanations-3"><i class="fa fa-check"></i><b>4.3</b> Explanations</a></li>
<li class="chapter" data-level="4.4" data-path="story-meps-regression.html"><a href="story-meps-regression.html#summary-and-conclusions-3"><i class="fa fa-check"></i><b>4.4</b> Summary and conclusions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="story-meps-healthcare-expenditures-of-individuals.html"><a href="story-meps-healthcare-expenditures-of-individuals.html"><i class="fa fa-check"></i><b>5</b> Story MEPS: Healthcare expenditures of individuals</a><ul>
<li class="chapter" data-level="5.1" data-path="story-meps-healthcare-expenditures-of-individuals.html"><a href="story-meps-healthcare-expenditures-of-individuals.html#introduction-4"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="story-meps-healthcare-expenditures-of-individuals.html"><a href="story-meps-healthcare-expenditures-of-individuals.html#models"><i class="fa fa-check"></i><b>5.2</b> Models</a><ul>
<li class="chapter" data-level="5.2.1" data-path="story-meps-healthcare-expenditures-of-individuals.html"><a href="story-meps-healthcare-expenditures-of-individuals.html#model-1-linear"><i class="fa fa-check"></i><b>5.2.1</b> Model 1: Linear</a></li>
<li class="chapter" data-level="5.2.2" data-path="story-meps-healthcare-expenditures-of-individuals.html"><a href="story-meps-healthcare-expenditures-of-individuals.html#model-2-ann"><i class="fa fa-check"></i><b>5.2.2</b> Model 2: ANN</a></li>
<li class="chapter" data-level="5.2.3" data-path="story-meps-healthcare-expenditures-of-individuals.html"><a href="story-meps-healthcare-expenditures-of-individuals.html#model-3-xgb"><i class="fa fa-check"></i><b>5.2.3</b> Model 3: XGB</a></li>
<li class="chapter" data-level="5.2.4" data-path="story-meps-healthcare-expenditures-of-individuals.html"><a href="story-meps-healthcare-expenditures-of-individuals.html#working-refs"><i class="fa fa-check"></i><b>5.2.4</b> Working refs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="story-uplift-marketing1.html"><a href="story-uplift-marketing1.html"><i class="fa fa-check"></i><b>6</b> Story Uplift modeling on marketing dataset: eXplainable predictions for optimized marketing campaigns</a><ul>
<li class="chapter" data-level="6.1" data-path="story-uplift-marketing1.html"><a href="story-uplift-marketing1.html#introduction-5"><i class="fa fa-check"></i><b>6.1</b> Introduction</a><ul>
<li class="chapter" data-level="6.1.1" data-path="story-uplift-marketing1.html"><a href="story-uplift-marketing1.html#approaches-towards-uplift-modeling"><i class="fa fa-check"></i><b>6.1.1</b> Approaches towards uplift modeling</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="story-uplift-marketing1.html"><a href="story-uplift-marketing1.html#dataset-1"><i class="fa fa-check"></i><b>6.2</b> Dataset</a><ul>
<li class="chapter" data-level="6.2.1" data-path="story-uplift-marketing1.html"><a href="story-uplift-marketing1.html#feature-engineering"><i class="fa fa-check"></i><b>6.2.1</b> Feature engineering</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="story-uplift-marketing1.html"><a href="story-uplift-marketing1.html#model-4"><i class="fa fa-check"></i><b>6.3</b> Model</a></li>
<li class="chapter" data-level="6.4" data-path="story-uplift-marketing1.html"><a href="story-uplift-marketing1.html#explanations-4"><i class="fa fa-check"></i><b>6.4</b> Explanations</a><ul>
<li class="chapter" data-level="6.4.1" data-path="story-uplift-marketing1.html"><a href="story-uplift-marketing1.html#instance-level"><i class="fa fa-check"></i><b>6.4.1</b> Instance-level</a></li>
<li class="chapter" data-level="6.4.2" data-path="story-uplift-marketing1.html"><a href="story-uplift-marketing1.html#dataset--subset--level"><i class="fa fa-check"></i><b>6.4.2</b> Dataset- (subset-) level</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="story-uplift-marketing1.html"><a href="story-uplift-marketing1.html#summary-and-conclusions-4"><i class="fa fa-check"></i><b>6.5</b> Summary and conclusions</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="story-uplift-marketing1.html"><a href="story-uplift-marketing1.html#story-uplift-marketing1"><i class="fa fa-check"></i><b>7</b> Story Uplift modeling on marketing dataset: eXplainable predictions for optimized marketing campaigns</a><ul>
<li class="chapter" data-level="7.1" data-path="story-uplift-marketing1.html"><a href="story-uplift-marketing1.html#introduction-6"><i class="fa fa-check"></i><b>7.1</b> Introduction</a><ul>
<li class="chapter" data-level="7.1.1" data-path="story-uplift-marketing1.html"><a href="story-uplift-marketing1.html#approaches-towards-uplift-modeling-1"><i class="fa fa-check"></i><b>7.1.1</b> Approaches towards uplift modeling</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="story-uplift-marketing1.html"><a href="story-uplift-marketing1.html#dataset-2"><i class="fa fa-check"></i><b>7.2</b> Dataset</a><ul>
<li class="chapter" data-level="7.2.1" data-path="story-uplift-marketing1.html"><a href="story-uplift-marketing1.html#feature-engineering-1"><i class="fa fa-check"></i><b>7.2.1</b> Feature engineering</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="story-uplift-marketing1.html"><a href="story-uplift-marketing1.html#model-5"><i class="fa fa-check"></i><b>7.3</b> Model</a></li>
<li class="chapter" data-level="7.4" data-path="story-uplift-marketing1.html"><a href="story-uplift-marketing1.html#explanations-wymaga-dopracowania"><i class="fa fa-check"></i><b>7.4</b> Explanations [wymaga dopracowania]</a><ul>
<li class="chapter" data-level="7.4.1" data-path="story-uplift-marketing1.html"><a href="story-uplift-marketing1.html#individual-perspective"><i class="fa fa-check"></i><b>7.4.1</b> Individual perspective</a></li>
<li class="chapter" data-level="7.4.2" data-path="story-uplift-marketing1.html"><a href="story-uplift-marketing1.html#data-scientist-perspective"><i class="fa fa-check"></i><b>7.4.2</b> Data scientist perspective</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="story-uplift-marketing1.html"><a href="story-uplift-marketing1.html#summary-and-conclusions-5"><i class="fa fa-check"></i><b>7.5</b> Summary and conclusions</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="story-uplift-marketing.html"><a href="story-uplift-marketing.html"><i class="fa fa-check"></i><b>8</b> Story Uplift modeling on marketing dataset: eXplainable predictions for optimized marketing campaigns</a><ul>
<li class="chapter" data-level="8.1" data-path="story-uplift-marketing.html"><a href="story-uplift-marketing.html#introduction-7"><i class="fa fa-check"></i><b>8.1</b> Introduction</a><ul>
<li class="chapter" data-level="8.1.1" data-path="story-uplift-marketing.html"><a href="story-uplift-marketing.html#approaches-towards-uplift-modelling"><i class="fa fa-check"></i><b>8.1.1</b> Approaches towards uplift modelling</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="story-uplift-marketing.html"><a href="story-uplift-marketing.html#dataset-3"><i class="fa fa-check"></i><b>8.2</b> Dataset</a></li>
<li class="chapter" data-level="8.3" data-path="story-uplift-marketing.html"><a href="story-uplift-marketing.html#model-6"><i class="fa fa-check"></i><b>8.3</b> Model</a></li>
<li class="chapter" data-level="8.4" data-path="story-uplift-marketing.html"><a href="story-uplift-marketing.html#explanations-5"><i class="fa fa-check"></i><b>8.4</b> Explanations</a></li>
<li class="chapter" data-level="8.5" data-path="story-uplift-marketing.html"><a href="story-uplift-marketing.html#summary-and-conclusions-6"><i class="fa fa-check"></i><b>8.5</b> Summary and conclusions</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="story-uplift-marketing1.html"><a href="story-uplift-marketing1.html#story-uplift-marketing1"><i class="fa fa-check"></i><b>9</b> Story Uplift modeling on marketing dataset: eXplainable predictions for optimized marketing campaigns</a><ul>
<li class="chapter" data-level="9.1" data-path="story-uplift-marketing1.html"><a href="story-uplift-marketing1.html#introduction-8"><i class="fa fa-check"></i><b>9.1</b> Introduction</a><ul>
<li class="chapter" data-level="9.1.1" data-path="story-uplift-marketing1.html"><a href="story-uplift-marketing1.html#approaches-towards-uplift-modeling-2"><i class="fa fa-check"></i><b>9.1.1</b> Approaches towards uplift modeling</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="story-uplift-marketing1.html"><a href="story-uplift-marketing1.html#dataset-4"><i class="fa fa-check"></i><b>9.2</b> Dataset</a><ul>
<li class="chapter" data-level="9.2.1" data-path="story-uplift-marketing1.html"><a href="story-uplift-marketing1.html#feature-engineering-2"><i class="fa fa-check"></i><b>9.2.1</b> Feature engineering</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="story-uplift-marketing1.html"><a href="story-uplift-marketing1.html#model-wymaga-dopracowania"><i class="fa fa-check"></i><b>9.3</b> Model [wymaga dopracowania]</a></li>
<li class="chapter" data-level="9.4" data-path="story-uplift-marketing1.html"><a href="story-uplift-marketing1.html#explanations-wymaga-dopracowania-1"><i class="fa fa-check"></i><b>9.4</b> Explanations [wymaga dopracowania]</a><ul>
<li class="chapter" data-level="9.4.1" data-path="story-uplift-marketing1.html"><a href="story-uplift-marketing1.html#individual-perspective-1"><i class="fa fa-check"></i><b>9.4.1</b> Individual perspective</a></li>
<li class="chapter" data-level="9.4.2" data-path="story-uplift-marketing1.html"><a href="story-uplift-marketing1.html#data-scientist-perspective-1"><i class="fa fa-check"></i><b>9.4.2</b> Data scientist perspective</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="story-uplift-marketing1.html"><a href="story-uplift-marketing1.html#summary-and-conclusions-7"><i class="fa fa-check"></i><b>9.5</b> Summary and conclusions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i>Examples</a><ul>
<li class="chapter" data-level="9.6" data-path="examples.html"><a href="examples.html#figures-and-citations"><i class="fa fa-check"></i><b>9.6</b> Figures and citations</a></li>
<li class="chapter" data-level="9.7" data-path="examples.html"><a href="examples.html#introduction-9"><i class="fa fa-check"></i><b>9.7</b> Introduction</a></li>
<li class="chapter" data-level="9.8" data-path="examples.html"><a href="examples.html#model-7"><i class="fa fa-check"></i><b>9.8</b> Model</a></li>
<li class="chapter" data-level="9.9" data-path="examples.html"><a href="examples.html#explanations-6"><i class="fa fa-check"></i><b>9.9</b> Explanations</a></li>
<li class="chapter" data-level="9.10" data-path="examples.html"><a href="examples.html#summary-and-conclusions-8"><i class="fa fa-check"></i><b>9.10</b> Summary and conclusions</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="story-lungs.html"><a href="story-lungs.html"><i class="fa fa-check"></i><b>10</b> Story lungs: eXplainable predictions for post operational risks</a><ul>
<li class="chapter" data-level="10.1" data-path="story-lungs.html"><a href="story-lungs.html#introduction-10"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="story-lungs.html"><a href="story-lungs.html#model-8"><i class="fa fa-check"></i><b>10.2</b> Model</a></li>
<li class="chapter" data-level="10.3" data-path="story-lungs.html"><a href="story-lungs.html#explanations-7"><i class="fa fa-check"></i><b>10.3</b> Explanations</a></li>
<li class="chapter" data-level="10.4" data-path="story-lungs.html"><a href="story-lungs.html#summary-and-conclusions-9"><i class="fa fa-check"></i><b>10.4</b> Summary and conclusions</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="story-compas.html"><a href="story-compas.html"><i class="fa fa-check"></i><b>11</b> Story COMPAS: recidivism reloaded</a><ul>
<li class="chapter" data-level="11.1" data-path="story-compas.html"><a href="story-compas.html#introduction-11"><i class="fa fa-check"></i><b>11.1</b> Introduction</a></li>
<li class="chapter" data-level="11.2" data-path="story-compas.html"><a href="story-compas.html#model-9"><i class="fa fa-check"></i><b>11.2</b> Model</a></li>
<li class="chapter" data-level="11.3" data-path="story-compas.html"><a href="story-compas.html#explanations-8"><i class="fa fa-check"></i><b>11.3</b> Explanations</a></li>
<li class="chapter" data-level="11.4" data-path="story-compas.html"><a href="story-compas.html#summary-and-conclusions-10"><i class="fa fa-check"></i><b>11.4</b> Summary and conclusions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="acknowledgements.html"><a href="acknowledgements.html"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">XAI Stories</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="story-uplift-marketing1" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Story Uplift modeling on marketing dataset: eXplainable predictions for optimized marketing campaigns</h1>
<p><em>Authors: Jan Ludziejewski (Warsaw University), Paulina Tomaszewska (Warsaw University of Technology), Andżelika Zalewska (Warsaw University of Technology)</em></p>
<p><em>Mentors: Łukasz Frydrych (McKinsey), Łukasz Pająk (McKinsey)</em></p>
<p><strong>Key points</strong>:</p>
<ul>
<li>uplift models thanks to its additivity give wide range of possiblities while using XAI<br />
</li>
<li>Shapley values can be used to explain model in different aspects - they can be used to estimate Variable importance and Partial Dependence Plots<br />
</li>
<li>[tutaj trzeba dopisać to co stricte dowiedzieliśmy się z uplift]</li>
</ul>
<div id="introduction-5" class="section level2">
<h2><span class="header-section-number">6.1</span> Introduction</h2>
<p>Running a business is a challenge. It involves making a lot of decisions to maximize profits and cut down costs - finding the tradeoff is not a straightforward task.
Here come Machine Learning and uplift models that can help in optimizing marketing costs.</p>
<p>It is widely believed that it is good idea to send marketing offer to all company’s customers. In fact it is not always a case – the matter has been described later. While large scale campaigns are costly it is important to consider Return on Investment (ROI) in decision-making.</p>
<p>Goal of this paper is to scientifically answer the question: <em>“Is it true that by sending the marketing offer we only extend the chance for the customer to buy our product and therefore extend our profit?”</em>.</p>
<p>The issue was already investigated <span class="citation">(Verbeke and Bravo <a href="#ref-book_uplift" role="doc-biblioref">2017</a>)</span> and it was pointed out that customers of any company can be divided into 4 groups (Figure: <a href="story-uplift-marketing1.html#fig:4groups">6.1</a>).</p>
<div class="figure" style="text-align: center"><span id="fig:4groups"></span>
<img src="images/09_e45e2d97-confmatrix_alt.png" alt="Customer types taking into consideration their response to treatment [@4groups_chart]" width="50%" />
<p class="caption">
FIGURE 6.1: Customer types taking into consideration their response to treatment <span class="citation">(Yi and Frost, <a href="#ref-4groups_chart" role="doc-biblioref">n.d.</a>)</span>
</p>
</div>
<p>The image matrix was created based on customer decision to buy a product depending on the fact that they were addressed by a marketing campaign or not. The action used for triggering in customers the particular behavior is called treatment. In the 4 groups we distinguish (Figure: <a href="story-uplift-marketing1.html#fig:4groups">6.1</a>):</p>
<ul>
<li><span style="color:darkgreen"><strong><em>“persuadables”</em></strong></span>: the customers that without being exposed to marketing campaign would <strong>NOT</strong> buy a product</li>
<li><span style="color:grey"><strong><em>“sure things”</em></strong></span>: the customers that irrespective of the fact that they experienced treatment or not are going to buy a product</li>
<li><span style="color:grey"><strong><em>“lost causes”</em></strong></span>: the customers that irrespective of the fact that they experienced treatment or not are <strong>NOT</strong> going to buy a product</li>
<li><span style="color:darkred"> <strong><em>“sleeping dogs”</em></strong></span>: the customers that without being exposed to marketing campaign would buy a product but in case they receive a marketing offer they resign</li>
</ul>
<p>It can be then observed that in case of <em>“lost causes”</em> and <em>“sure things”</em> sending a marketing offer makes no impact therefore it doesn’t make sense to spend money on targeting these customers. As the company we should however pay more attention to the groups <em>“persuadables”</em> and <em>“sleeping dogs”</em>. In the case of the first group, bearing the costs of the marketing campaign will bring benefits. In the case of the latter, we not only spend money on targeting them but as a result, we will also discourage them from buying the product therefore we as a company lose twice. The case of <em>“sleeping dogs”</em> can seem irrealistic, therefore we present an example.</p>
<blockquote>
<p><em>Let’s imagine there is a customer that subscribed to our paid newsletter. He forgot that he pays each month fixed fee. He would continue paying unless a company sends him a discount offer. At this moment the customer realizes that he doesn’t need the product and unsubscribes.</em></p>
</blockquote>
<p>By understanding the structure of the company’s customers, it can target its offer more effectively.</p>
<div id="approaches-towards-uplift-modeling" class="section level3">
<h3><span class="header-section-number">6.1.1</span> Approaches towards uplift modeling</h3>
<p>In <span class="citation">(Akshay Kumar <a href="#ref-uplift_stanford" role="doc-biblioref">2018</a>)</span> it was pointed out that the problem of deciding whether it is profitable to send an offer to a particular customer can be tackled from two different perspectives:</p>
<ul>
<li>predictive response modeling (it is classical classification task where model assigns a probability to each of the classes)<br />
</li>
<li>uplift modeling (where the “incremental” probability of purchase is modeled)</li>
</ul>
<p>The latter is tailored to this particular task and is more challenging.
<strong>Uplift modeling is a technique that helps to determine probability gain that the customer by getting the marketing materials will buy a product.</strong>
The field is relatively new. The two most common approaches are <span class="citation">(Lee <a href="#ref-uplift_approaches" role="doc-biblioref">2018</a>)</span>:</p>
<ul>
<li><p><strong>Two Model</strong><br />
In this method two classifiers are build. The one is trained on observations that received treatment <em>(model_T1)</em> and the second is trained on observations that didn’t receive treatment <em>(model_T0)</em>. Later the uplift for particular observations is calculated. If the observation experienced treatment then it is an input to the <em>model_T1</em> and the probability that the customer will buy a product is calculated. Next it is investigated what would happen if the customer didn’t receive treatment. In that case the treatment indicator in observation’s feature is changed to “zero”. Such a modified record is an input to <em>model_T0</em> that predicts the probability that such a customer will buy a product. The uplift is calculated as the difference between the output of the <em>model_T1</em> and <em>model_T0</em>. The higher the difference, the more profitable is addressing marketing campaign to a particular customer. Analogically, uplift is computed for the people that didn’t experienced treatment.</p></li>
<li><p><strong>One Model</strong><br />
This approach is similar conceptually to the Two model approach with such a difference that instead of building two classifiers only one is used. Therefore every observation is an input to the model that generates prediction. Later the indicator in the treatment column is changed into the negation and such a vector is used as input to the model that once again output probability that the customer buys a product. The uplift is the difference between the two predicted probabilities.</p></li>
</ul>
<div class="figure" style="text-align: center"><span id="fig:approches"></span>
<img src="images/09_one_two_model.png" alt="Two Model vs One Model approach (own elaboration)" width="100%" />
<p class="caption">
FIGURE 6.2: Two Model vs One Model approach (own elaboration)
</p>
</div>
<p>As uplift modeling is an emerging field there isn’t a clear evidence what method is better to use.
In <span class="citation">(Zaniewicz and Jaroszewicz <a href="#ref-uplift_svm" role="doc-biblioref">2013</a>)</span>, the authors investigated the application of SVM (<em>support vector machine</em>). But since SVM requires precise, long-lasting finetuning we decided to use XGBoost (the architecture of our solution is described in detail in section Model).</p>
</div>
</div>
<div id="dataset-1" class="section level2">
<h2><span class="header-section-number">6.2</span> Dataset</h2>
<p>There is a scarcity of well-documented datasets dedicated to uplift modeling. Therefore the authors of <span class="citation">(Rzepakowski and Jaroszewicz <a href="#ref-uplift_dataset_modification" role="doc-biblioref">2012</a>)</span> proposed to artificially modify available datasets to extract information about treatment. As the purpose of this story is to investigate XAI techniques in the domain of uplift modeling we decided to use real-life dataset.
We chose Kevin Hillstrom’s dataset from E-Mail Analytics And Data Mining Challenge <span class="citation">(Hillstrom <a href="#ref-uplift_dataset_marketing" role="doc-biblioref">2008</a>)</span>. The dataset consists of 64000 records reflecting customers that last purchased within 12 months. As a treatment an e-mail campaign was addressed:</p>
<ul>
<li>1/3 of customers were randomly chosen to receive an e-mail campaign featuring Men’s merchandise</li>
<li>1/3 were randomly chosen to receive an e-mail campaign featuring Women’s merchandise</li>
<li>1/3 were randomly chosen to not receive an e-mail campaign <em>(“control group”)</em></li>
</ul>
<p>As an expected behavior the following actions were determined:</p>
<ul>
<li>visit the company’s website within 2 weeks after sending to the customers a marketing campaign</li>
<li>purchase a product from the website within 2 weeks after sending to the customers a marketing campaign</li>
</ul>
<p>In the challenge the task was to determine whether the Men’s or Women’s e-mail campaign was successful. In our task we reformulated the task and we wanted to answer the question of whether any e-mail campaign was profitable for the company.</p>
<p>The features about customers in the dataset are specified in Figure <a href="story-uplift-marketing1.html#fig:dataset">6.3</a>:</p>
<div class="figure" style="text-align: center"><span id="fig:dataset"></span>
<img src="images/09_xai_customer.jpg" alt="Customer features in the dataset (own elaboration)" width="100%" />
<p class="caption">
FIGURE 6.3: Customer features in the dataset (own elaboration)
</p>
</div>
<p>There is also information about customer activity in the two weeks following delivery of the e-mail campaign (these can be interpreted as labels):</p>
<ul>
<li>Visit: 1/0 indicator, 1 = Customer visited website in the following two weeks.</li>
<li>Conversion: 1/0 indicator, 1 = Customer purchased merchandise in the following two weeks.</li>
<li>Spent: Actual dollars spent in the following two weeks.</li>
</ul>
<div id="feature-engineering" class="section level3">
<h3><span class="header-section-number">6.2.1</span> Feature engineering</h3>
<p>The dataset is largely imbalanced - there are only about 15% of positive cases in column <em>Visit</em> and 9% in column <em>Conversion</em>.
In such a situation we decided to use column <em>Visit</em> as a target for the classifier.
As the number of columns is small we decided to use one-hot encoding for transforming categorical variables instead of target encoding.</p>
</div>
</div>
<div id="model-4" class="section level2">
<h2><span class="header-section-number">6.3</span> Model</h2>
<p>There are not many packages dedicated to uplift modeling in python. We investigated the two: pylift <span class="citation">(Yi and Frost <a href="#ref-pylift" role="doc-biblioref">2018</a>)</span> and pyuplift <span class="citation">(Kuchumov <a href="#ref-pyuplift" role="doc-biblioref">2018</a>)</span>. The latter enables usage of 4 types of models - one of those is the Two Model approach. In the pylift package there is the TransformedOutcome class that generates predictions. However, the model itself is not well described and uses XGBRegressor underneath that is not intuitive. Fortunately the package offer also the class UpliftEval that allows uplift metrics visualization.
In the scene, we decided to create own classifier (as in the One Model approach) and use UpliftEval class from the pylift model for metric evaluation.
As the classifier we used fine-tuned XGBoost with the score function as the area under the cumulative gain chart (described below). In the figure <a href="story-uplift-marketing1.html#fig:upliftRES">6.4</a> we show the cumulative gain chart for train and test sets.</p>
<div class="figure"><span id="fig:upliftRES"></span>
<img src="images/09_uplift_train.png" alt="Cumulative gain chart: (left) train set, (right) test set" width="50%" /><img src="images/09_uplift_test.png" alt="Cumulative gain chart: (left) train set, (right) test set" width="50%" />
<p class="caption">
FIGURE 6.4: Cumulative gain chart: (left) train set, (right) test set
</p>
</div>
<p>In order to evaluate performance of uplift models The Qini curve is not suggested as it is vulnerable to overfitting to the treatment label. Therefore the Cumulative gain chart is used. It is the most unbiased estimate of the uplift. In the package Pylift it is implemented based on the formula:
<span class="math inline">\(Cumulative\ gain(\phi) = (\frac {n_{t,1}(\phi)}{n_{t,1}}-\frac {n_{c,1}(\phi)}{n_{c,1}})(\frac{n_t(\phi)+n_c(\phi)}{N_t+N_c})\)</span><br />
where<br />
<span class="math inline">\(n_{t,1} (\phi)\)</span> is the number of observations in the treatment group at cutoff level <span class="math inline">\(\phi\)</span> with label 1<br />
<span class="math inline">\(n_{c,1} (\phi)\)</span> is the number of observations in the control group at cutoff level <span class="math inline">\(\phi\)</span> with label 1<br />
<span class="math inline">\(n_{t,1}\)</span> is the total number of observations in the treatment group with label 1 (analogically <span class="math inline">\(n_{c,1}\)</span>)<br />
<span class="math inline">\(N_t\)</span> is the total number of observations in treatment group (analogically <span class="math inline">\(N_c\)</span>)</p>
<p>The plot can be interpreted as follows:<br />
First the customers are sorted in descending order based on predicted uplift. Later some friction of data is taken for the analysis (e.g. 10% of the people with the highest score). This cutoff is represented as <span class="math inline">\(\phi\)</span> in the formula. Next the uplift gain is verified for the subset. At the beginning of the curve the gain is the biggest as it refers to the <em>“persuadables”</em> group. Later the curve stabilizes as it depicts the groups: <em>“lost causes”</em> and <em>“sure things”</em>. In the end the curve decrease as there are <em>“sleeping dogs”</em> with negative uplift.</p>
<p>It can be seen that our model is better than random choice but much worse than the practical/theoretical maximum possible. It is also worse than the case without <em>“sleeping dogs”</em>.
It is worth noticing that our model didn’t experience overfitting as its quality on the train and test sets is similar.</p>
</div>
<div id="explanations-4" class="section level2">
<h2><span class="header-section-number">6.4</span> Explanations</h2>
<p>The Cumulative Gain chart shows that the proposed model brings additional value. Here comes the question of whether the model is reliable? Does it make the decision based on the features that are important from an expert knowledge perspective? Such judgment can be done based on the results of XAI tools.
We decided to investigate model interpretability from instance-level and dataset-level perspective.</p>
<div id="instance-level" class="section level3">
<h3><span class="header-section-number">6.4.1</span> Instance-level</h3>
<p>In order to explain model output for particular customer we employed Shapley values <span class="citation">(Lundberg and Lee <a href="#ref-feature_importance_shap" role="doc-biblioref">2017</a>)</span>.</p>
<p>Before we move to the investigation of Shapley values let’s get to know customers that got the highest and the lowest uplift. In this section we will analyze the reliability of predictions for these particular instances. In the table <a href="story-uplift-marketing1.html#tab:personalTABLE">6.1</a> there is all the information provided to the system about the customers.</p>
<table>
<caption><span id="tab:personalTABLE">TABLE 6.1: </span>Customer with the highest and the lowest uplift - features</caption>
<thead>
<tr class="header">
<th align="left">Column.name</th>
<th align="left">customer_with_biggest_uplift</th>
<th align="left">customer_with_lowest_uplift</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">recency</td>
<td align="left">2.0</td>
<td align="left">5.0</td>
</tr>
<tr class="even">
<td align="left">history</td>
<td align="left">228.93</td>
<td align="left">243.95</td>
</tr>
<tr class="odd">
<td align="left">mens</td>
<td align="left">1.0</td>
<td align="left">0.0</td>
</tr>
<tr class="even">
<td align="left">womens</td>
<td align="left">1.0</td>
<td align="left">1.0</td>
</tr>
<tr class="odd">
<td align="left">zip_code_Surburban</td>
<td align="left">1.0</td>
<td align="left">0.0</td>
</tr>
<tr class="even">
<td align="left">zip_code_Rural</td>
<td align="left">0.0</td>
<td align="left">1.0</td>
</tr>
<tr class="odd">
<td align="left">zip_code_Urban</td>
<td align="left">0.0</td>
<td align="left">0.0</td>
</tr>
<tr class="even">
<td align="left">newbie</td>
<td align="left">0.0</td>
<td align="left">1.0</td>
</tr>
<tr class="odd">
<td align="left">channel_Phone</td>
<td align="left">0.0</td>
<td align="left">1.0</td>
</tr>
<tr class="even">
<td align="left">channel_Web</td>
<td align="left">1.0</td>
<td align="left">0.0</td>
</tr>
<tr class="odd">
<td align="left">channel_Multichannel</td>
<td align="left">0.0</td>
<td align="left">0.0</td>
</tr>
<tr class="even">
<td align="left">segment</td>
<td align="left">0.0</td>
<td align="left">1.0</td>
</tr>
</tbody>
</table>
<p>As can be seen the customers spend almost the same amount of money during the last 12 months on our company’s products.
The person with the highest uplift did last shopping 2 months ago whereas the person with the lowest uplift did it 5 months ago. In the dataset some people purchased the product for the last time even 12 months ago so the person is not the most severe case in that sense. Apart from many other differences among the two customers the key is that the person with the highest uplift received treatment whereas the second customer didn’t.
[wstawić histogram recency i history!!!]</p>
Below we present Shapley values for the customer desribed in <a href="story-uplift-marketing1.html#tab:personalTABLE">6.1</a>. The values were computed directly on uplift model <a href="story-uplift-marketing1.html#fig:upliftSHAP">6.5</a>.
<div class="figure"><span id="fig:upliftSHAP"></span>
<img src="images/09_shap_min_uplift.png" alt="Shapley values: (left) customer with the lowest uplift, (right) customer with the highest uplift" width="50%" /><img src="images/09_shap_max_uplift.png" alt="Shapley values: (left) customer with the lowest uplift, (right) customer with the highest uplift" width="50%" />
<p class="caption">
FIGURE 6.5: Shapley values: (left) customer with the lowest uplift, (right) customer with the highest uplift
</p>
</div>
<p>Conclusions:<br />
In can be seen that in both cases big contribution to the final result has information about customer history (about 230 USD) and the fact that the customer bought products from Womens collection. What is interestin is the fact that the customers have almost the same values of these two attribute but opposite sign of its contribution.</p>
<p>We can benefit from additive feature attribution property of Shapley values to model the uplift:</p>
<p><span class="math inline">\(uplift=P(purchase|\ treatment=1) - P(purchase|\ treatment=0))\)</span>
<span class="math inline">\(SHAP(uplift)= SHAP(P(purchase|\ treatment=1)) - SHAP(P(purchase|\ treatment=0))\)</span></p>
<p>This property gives us a great opportunity to evaluate these two vectors of Shapley values independently. For example if we use any tree-based model, we can make use of tree-based kernel for Shapley value estimation (faster and better convergent) instead of modeling it directly as a black-box (uplift) model.</p>
<p>Experimental results proved, that these two ways of calculation are providing close estimations, with precision to numerical errors.</p>
<p>In a table <a href="story-uplift-marketing1.html#tab:upliftTABLE">6.2</a> there is a comparison of Shapley values obtained using two methods for the customer with the lowest uplift.</p>
<table>
<caption><span id="tab:upliftTABLE">TABLE 6.2: </span>Shapley values obtained using two methods</caption>
<thead>
<tr class="header">
<th align="left">Column_name</th>
<th align="left">Uplift_approach</th>
<th align="left">Diff_approach</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">recency</td>
<td align="left">-0.00593</td>
<td align="left">-0.00535</td>
</tr>
<tr class="even">
<td align="left">history</td>
<td align="left">-0.27282</td>
<td align="left">-0.27270</td>
</tr>
<tr class="odd">
<td align="left">mens</td>
<td align="left">-0.00961</td>
<td align="left">-0.00928</td>
</tr>
<tr class="even">
<td align="left">womens</td>
<td align="left">-0.05628</td>
<td align="left">-0.05692</td>
</tr>
<tr class="odd">
<td align="left">zip_code_Surburban</td>
<td align="left">0.00076</td>
<td align="left">-0.00055</td>
</tr>
<tr class="even">
<td align="left">zip_code_Rural</td>
<td align="left">-0.03313</td>
<td align="left">-0.03257</td>
</tr>
<tr class="odd">
<td align="left">zip_code_Urban</td>
<td align="left">-0.00148</td>
<td align="left">-0.00179</td>
</tr>
<tr class="even">
<td align="left">newbie</td>
<td align="left">0.00365</td>
<td align="left">0.00351</td>
</tr>
<tr class="odd">
<td align="left">channel_Phone</td>
<td align="left">0.00024</td>
<td align="left">-0.00036</td>
</tr>
<tr class="even">
<td align="left">channel_Web</td>
<td align="left">0.00188</td>
<td align="left">0.00200</td>
</tr>
<tr class="odd">
<td align="left">channel_Multichannel</td>
<td align="left">-0.00067</td>
<td align="left">0.00029</td>
</tr>
<tr class="even">
<td align="left">segment</td>
<td align="left">0.00010</td>
<td align="left">0.00043</td>
</tr>
</tbody>
</table>
<p>Experimental results proved, that these two ways of calculation are providing close estimations, with precision to numerical errors There are few feature that depending on method have small positive or negative Shapley value. This is caused by the fact that for the estimation of Shapley values directly using uplift model the KernelExplainer was used. It has data parameter however in case of big dataset it is recommended in the documentation to take subset od records. In our case we took random subset therefore this could impact the results. Nevertheless, we proved that in case of our example the two methods lead to similar values.</p>
<p>The specificity of uplift models in terms of the possibility to analyse them through additivity of Shapley values gives room for another valuable inspection.
Below we present how Shapley values differ depending on the fact that the customer was or wasn’t addressed by treatment. On <em>x</em> axis there are Shapley values in case T=0 and on y axis in case T=1.In each chart there is Shapley value referring to one variable. In situation when the Shapley values are the same irrespective of the presence or absence of treatment they would lie on identity line. Moreover, there is color used as third dimension indicating the group that the particular customer belongs to. The division is made based on predicted uplift. As almost all customers were categorized to <em>“persuadables”</em>, we decided to show on the plot only 1000 records from this group to maintain chart readability.</p>
<div class="figure" style="text-align: center"><span id="fig:recencySHAP"></span>
<img src="images/09_shap_recency.PNG" alt="Shapley values on variable recency in case T=0 and T=1" width="50%" />
<p class="caption">
FIGURE 6.6: Shapley values on variable recency in case T=0 and T=1
</p>
</div>
It can be seen that <em>“persuadables”</em> are slightly above and below identity line as we have set <span class="math inline">\(\epsilon\)</span> value as +-0.01.
<div class="figure" style="text-align: center"><span id="fig:historySHAP"></span>
<img src="images/09_shap_history.PNG" alt="Shapley values on variable history in case T=0 and T=1" width="50%" />
<p class="caption">
FIGURE 6.7: Shapley values on variable history in case T=0 and T=1
</p>
</div>
<p>In Figure <a href="story-uplift-marketing1.html#fig:historySHAP">6.7</a> it can be seen that three customer groups are distinctive groups that could have been obtained trough clustering methods.</p>
Apart from continuous variable we also investigated binary variable. Most of them looked similar as Figure <a href="story-uplift-marketing1.html#fig:historySHAP">6.7</a> but there was one exception - variable <em>womens</em>.
<div class="figure" style="text-align: center"><span id="fig:womensSHAP"></span>
<img src="images/09_shap_womens.PNG" alt="Shapley values on variable womens in case T=0 and T=1" width="50%" />
<p class="caption">
FIGURE 6.8: Shapley values on variable womens in case T=0 and T=1
</p>
</div>
<p>It can be seen that the customer groups are overlapping. They constitue very homogenous groups.</p>
<p>Conclusions:<br />
In the case of our model there is no need to apply LIME as its main advantages - sparsity - is not important as we have few columns.</p>
</div>
<div id="dataset--subset--level" class="section level3">
<h3><span class="header-section-number">6.4.2</span> Dataset- (subset-) level</h3>
<p>Unfortunately, it’s impossible to calculate directly Permutation Feature Importance, because of the previously mentioned problem with lack of full information in both cases: Will the client purchase after treatment, and will be without it. Because of having in disposal only historical data (not an oracle), we have only one of these two pieces of information. However, we can make use of the previously computed Shapley values of uplift to calculate the same value of permutational feature importance as an average of local Shapley importance (defined in a permutational way itself, however, calculated more smartly, more in <span class="citation">(Lundberg and Lee <a href="#ref-feature_importance_shap" role="doc-biblioref">2017</a>)</span>.</p>
<p>We decided to evaluate feature importance not from the well-known dataset-level but subset-level. We extracted from the dataset 3 groups: <em>“sleeping dogs”</em>, <em>“persuadables”</em> and “no impact” (this group is a merge of the groups: <em>“sure things”</em> and <em>“lost causes”</em>). The division was based on the predicted uplift. <em>“Sleeping dogs”</em> have negative uplift, “no impact” have uplift from zero to the defined epsilon and <em>“persuadables”</em> have uplift greater than epsilon. We decided to not take into consideration epsilon in the case of <em>“sleeping dogs”</em> as we want to be more conservative. The worst thing the company can do is to discourage the customer from buying.</p>
<div class="figure" style="text-align: center"><span id="fig:sleepingDOGS"></span>
<img src="images/09_sleeping_dogs_feature_importance.PNG" alt="Variable importance - &quot;sleeping dogs&quot;" width="60%" />
<p class="caption">
FIGURE 6.9: Variable importance - “sleeping dogs”
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:noIMPACT"></span>
<img src="images/09_sure_things_lost_cases_feature_importance.PNG" alt="Variable importance - &quot;no impact&quot;" width="60%" />
<p class="caption">
FIGURE 6.10: Variable importance - “no impact”
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:persuadables"></span>
<img src="images/09_persuadables_feature_importance.PNG" alt="Variable importance - &quot;persuadables&quot;" width="60%" />
<p class="caption">
FIGURE 6.11: Variable importance - “persuadables”
</p>
</div>
<p>You may ask how to show a dependence plot. You have two options. The most common method is the Partial Dependence Plot and the different one is the SHAP dependence plot. The Partial Dependence Plot shows the marginal effect one or two features have on the predicted outcome of a machine learning model <span class="citation">(<span class="citeproc-not-found" data-reference-id="pdp"><strong>???</strong></span>)</span>. It tells whether the relationship between the target and a feature is linear, monotonic or more complex. In order to create a dependence plot, you can also use The SHAP dependence plot, which shows how a feature’s value (x-axis) impacted the prediction (y-axis) of every sample (each dot) in a dataset <span class="citation">(Lundberg et al. <a href="#ref-shap_dependence_plot" role="doc-biblioref">2019</a>)</span>. This provides richer information than traditional Partial Dependence Plot, so you may see that the SHAP value is a great tool among others, because we have at least two additional information: density, variety of observations.???????</p>
<p>We generated the Partial Dependence Plot for all features and the SHAP dependence plot based on 1k observations only for <em>history</em> and <em>recency</em> features.</p>
<div class="figure">
<img src="images/history_PDP_ALE.PNG" alt="(left) Partial Dependence Plot / Accumulated Local Effects plot, (right) The SHAP Dependence Plot based on 1k observations" width="50%" /><img src="images/history_shap_dependence_plot.PNG" alt="(left) Partial Dependence Plot / Accumulated Local Effects plot, (right) The SHAP Dependence Plot based on 1k observations" width="50%" />
<p class="caption">
(#fig:pdp_history)(left) Partial Dependence Plot / Accumulated Local Effects plot, (right) The SHAP Dependence Plot based on 1k observations
</p>
</div>
<p>For our model The SHAP Dependence Plot reflects the shape of the Partial Dependence Plot, while also highlighting the impact of <em>history</em> on uplift prediction is extremely different for people with the same value of <em>history</em>. Many individuals have a recorded <em>history</em> of 250 dollars in our dataset, but the impact of that measurement on their uplift varies.</p>
<div class="figure">
<img src="images/recency_PDP_ALE.PNG" alt="(left) Partial Dependence Plot / Accumulated Local Effects plot, (right) The SHAP Dependence Plot based on 1k observations" width="50%" /><img src="images/recency_shap_dependence_plot.PNG" alt="(left) Partial Dependence Plot / Accumulated Local Effects plot, (right) The SHAP Dependence Plot based on 1k observations" width="50%" />
<p class="caption">
(#fig:pdp_recency)(left) Partial Dependence Plot / Accumulated Local Effects plot, (right) The SHAP Dependence Plot based on 1k observations
</p>
</div>
<div class="figure" style="text-align: center">
<img src="images/mens_womens_PDP_ALE.PNG" alt="Partial Dependence Plot / Accumulated Local Effects plot" width="100%" />
<p class="caption">
(#fig:pdp_mens_womens)Partial Dependence Plot / Accumulated Local Effects plot
</p>
</div>
<div class="figure" style="text-align: center">
<img src="images/zip_PDP_ALE.PNG" alt="Partial Dependence Plot / Accumulated Local Effects plot" width="100%" />
<p class="caption">
(#fig:pdp_zip)Partial Dependence Plot / Accumulated Local Effects plot
</p>
</div>
<div class="figure" style="text-align: center">
<img src="images/newbie_PDP_ALE.PNG" alt="Partial Dependence Plot / Accumulated Local Effects plot" width="50%" />
<p class="caption">
(#fig:pdp_newbie)Partial Dependence Plot / Accumulated Local Effects plot
</p>
</div>
<div class="figure" style="text-align: center">
<img src="images/channel_PDP_ALE.PNG" alt="Partial Dependence Plot / Accumulated Local Effects plot" width="100%" />
<p class="caption">
(#fig:pdp_channel)Partial Dependence Plot / Accumulated Local Effects plot
</p>
</div>
</div>
</div>
<div id="summary-and-conclusions-4" class="section level2">
<h2><span class="header-section-number">6.5</span> Summary and conclusions</h2>
<p>Using XAI for uplift modeling helps to understand its complex models better. The analysis goes beyond just assessing whether the model is reliable… it can help the executive to understand better the company customers - their behavior without paying for some extra surveys to investigate their attitude towards the company.</p>
<p>A vital part of our work was adjusting XAI techniques for the particularities of uplift modeling. We found out that thanks to its additivity Shapley values are well suited for uplift modeling - we showed two methods of using it. We identified limitations of well-known Permutation Feature Importance in terms of explaining uplift modeling. It is caused by the fact that unlike in other supervised models here we do not have exactly labels. Therefore we used the generalization of Shapley values that converge to Permutation Feature Importance. We employed the analysis for the three groups of customers based on the corresponding uplift.</p>
<p>…………………………………..</p>
<p>Here add the most important conclusions related to the XAI analysis.
What did you learn?
Where were the biggest difficulties?
What else did you recommend?</p>
<p>zdaje misie tez ze patrzac na sama kubelkowosc danych (tzn pomijajac hisotry ktore teraz sie wybilo bo mamy przetrenowany model zeby miec sleeping dogi xD) to po prostu musi tam byc wiele przypadkow o ktorych wiemy dokladnie to samo i maja rozne odpowiedzi</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-uplift_stanford">
<p>Akshay Kumar, Rishabh Kumar. 2018. “Uplift Modeling : Predicting Incremental Gains.” 2018. <a href="http://cs229.stanford.edu/proj2018/report/296.pdf">http://cs229.stanford.edu/proj2018/report/296.pdf</a>.</p>
</div>
<div id="ref-uplift_dataset_marketing">
<p>Hillstrom, Kevin. 2008. “The Minethatdata E-Mail Analytics and Data Mining Challenge Dataset.” 2008. <a href="https://blog.minethatdata.com/2008/03/minethatdata-e-mail-analytics-and-data.html">https://blog.minethatdata.com/2008/03/minethatdata-e-mail-analytics-and-data.html</a>.</p>
</div>
<div id="ref-pyuplift">
<p>Kuchumov, Artem. 2018. “Pyuplift Package - Documentation.” 2018. <a href="https://pyuplift.readthedocs.io/en/latest/index.html">https://pyuplift.readthedocs.io/en/latest/index.html</a>.</p>
</div>
<div id="ref-uplift_approaches">
<p>Lee, Josh Xin Jie. 2018. “Simple Machine Learning Techniques to Improve Your Marketing Strategy: Demystifying Uplift Models.” 2018. <a href="https://medium.com/datadriveninvestor/simple-machine-learning-techniques-to-improve-your-marketing-strategy-demystifying-uplift-models-dc4fb3f927a2">https://medium.com/datadriveninvestor/simple-machine-learning-techniques-to-improve-your-marketing-strategy-demystifying-uplift-models-dc4fb3f927a2</a>.</p>
</div>
<div id="ref-feature_importance_shap">
<p>Lundberg, Scott, and Su-In Lee. 2017. “A Unified Approach to Interpreting Model Predictions.” In.</p>
</div>
<div id="ref-shap_dependence_plot">
<p>Lundberg, Scott M., Gabriel G. Erion, Hugh Chen, Alex DeGrave, Jordan M. Prutkin, Bala Nair, Ronit Katz, Jonathan Himmelfarb, Nisha Bansal, and Su-In Lee. 2019. “Explainable AI for Trees: From Local Explanations to Global Understanding.” <em>CoRR</em> abs/1905.04610. <a href="http://arxiv.org/abs/1905.04610">http://arxiv.org/abs/1905.04610</a>.</p>
</div>
<div id="ref-uplift_dataset_modification">
<p>Rzepakowski, Piotr, and Szymon Jaroszewicz. 2012. “Decision Trees for Uplift Modeling with Single and Multiple Treatments.” <em>Knowledge and Information Systems - KAIS</em> 32 (August). <a href="https://doi.org/10.1007/s10115-011-0434-0">https://doi.org/10.1007/s10115-011-0434-0</a>.</p>
</div>
<div id="ref-book_uplift">
<p>Verbeke, W., and C. Bravo. 2017. <em>Profit Driven Business Analytics: A Practitioner’s Guide to Transforming Big Data into Added Value</em>. Wiley and Sas Business Series. Wiley. <a href="https://books.google.pl/books?id=NCA3DwAAQBAJ">https://books.google.pl/books?id=NCA3DwAAQBAJ</a>.</p>
</div>
<div id="ref-pylift">
<p>Yi, Robert, and Will Frost. 2018. “Pylift Package - Documentation.” 2018. <a href="https://pylift.readthedocs.io/en/latest/">https://pylift.readthedocs.io/en/latest/</a>.</p>
</div>
<div id="ref-4groups_chart">
<p>Yi, Robert, and Will Frost. n.d. “Pylift: A Fast Python Package for Uplift Modeling.” <a href="https://tech.wayfair.com/data-science/2018/10/pylift-a-fast-python-package-for-uplift-modeling/">https://tech.wayfair.com/data-science/2018/10/pylift-a-fast-python-package-for-uplift-modeling/</a>.</p>
</div>
<div id="ref-uplift_svm">
<p>Zaniewicz, Lukasz, and Szymon Jaroszewicz. 2013. “Support Vector Machines for Uplift Modeling.” In <em>2013 Ieee 13th International Conference on Data Mining Workshops</em>, 131–38. IEEE.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="story-meps-healthcare-expenditures-of-individuals.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="story-uplift-marketing1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/compstat-lmu/iml_methods_limitations/edit/master/09_Uplift_marketing.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["book.pdf", "book.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
